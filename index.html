<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Buscador Weichai – Generadores y Motores</title>
  <style>
    :root{
      /* Paleta inspirada en Weichai (azul + rojo) */
      --w-blue-900:#082E5A;
      --w-blue-800:#0A3B73;
      --w-blue-700:#0B4DA2;
      --w-blue-600:#1662C4;
      --w-blue-100:#EAF2FF;

      --w-red-600:#E60012;

      --bg:#071B33;
      --card:#0B2547;
      --card-2:#0E2D56;
      --border:rgba(255,255,255,.10);
      --text:#EAF2FF;
      --muted:rgba(234,242,255,.75);

      --shadow: 0 14px 34px rgba(0,0,0,.35);
      --radius:18px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 20% -10%, rgba(11,77,162,.55), transparent 60%),
        radial-gradient(900px 600px at 110% 10%, rgba(230,0,18,.20), transparent 55%),
        linear-gradient(180deg, #041226 0%, #061a34 40%, #041226 100%);
      min-height:100vh;
    }

    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 22px 16px 34px;
    }

    .header{
      display:flex;
      gap:14px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
      padding: 14px 14px 8px;
    }
    .brand{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width: 240px;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      width:max-content;
      padding:7px 10px;
      border-radius:999px;
      background: rgba(11,77,162,.18);
      border:1px solid rgba(11,77,162,.35);
      color: var(--text);
      font-weight: 650;
      letter-spacing:.2px;
      font-size: 12.5px;
    }
    .dot{
      width:10px;height:10px;border-radius:50%;
      background: var(--w-red-600);
      box-shadow: 0 0 0 4px rgba(230,0,18,.15);
    }
    h1{
      margin: 0;
      font-size: clamp(18px, 2.3vw, 26px);
      letter-spacing:.2px;
    }
    .sub{
      margin:0;
      color: var(--muted);
      font-size: 13.5px;
      line-height:1.4;
    }

    .panel{
      margin-top: 10px;
      background: rgba(11,37,71,.65);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .controls{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 12px;
      padding: 14px;
      background: linear-gradient(180deg, rgba(14,45,86,.92), rgba(11,37,71,.65));
      border-bottom:1px solid var(--border);
    }
    @media (max-width: 720px){
      .controls{ grid-template-columns: 1fr; }
    }

    label{
      display:block;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
      letter-spacing:.2px;
    }

    .select, .search{
      width:100%;
      border-radius: 14px;
      border:1px solid rgba(234,242,255,.22);
      background: rgba(234,242,255,.95);
      color: #071B33;
      padding: 12px 12px;
      font-size: 14px;
      outline:none;
    }
    .select:focus, .search:focus{
      border-color: rgba(230,0,18,.65);
      box-shadow: 0 0 0 4px rgba(230,0,18,.16);
    }

    .hint{
      padding: 0 14px 14px;
      color: var(--muted);
      font-size: 12.5px;
      line-height:1.45;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 14px;
      padding: 14px;
    }
    @media (max-width: 860px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      background: linear-gradient(180deg, rgba(14,45,86,.92), rgba(11,37,71,.8));
      border:1px solid var(--border);
      border-radius: var(--radius);
      overflow:hidden;
      box-shadow: 0 10px 26px rgba(0,0,0,.25);
    }
    .cardTop{
      display:flex;
      gap: 12px;
      padding: 14px;
      align-items: stretch;
    }
    .imgBox{
      width: 150px;
      min-width: 150px;
      height: 120px;
      border-radius: 14px;
      overflow:hidden;
      background: rgba(234,242,255,.08);
      border:1px solid rgba(234,242,255,.14);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
    }
    .imgBox.hidden{ display:none; }
    @media (max-width: 520px){
      .cardTop{ flex-direction: column; }
      .imgBox{
        width:100%;
        min-width: unset;
        height: 190px;
      }
    }

    .imgBox img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }

    .content{
      flex:1;
      display:flex;
      flex-direction:column;
      gap: 10px;
      min-width: 0;
    }
    .titleRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
    }
    .title{
      margin:0;
      font-size: 16px;
      line-height:1.2;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius:999px;
      font-size: 12px;
      font-weight: 700;
      letter-spacing:.2px;
      border:1px solid rgba(234,242,255,.16);
      background: rgba(234,242,255,.08);
      color: var(--text);
      white-space:nowrap;
    }
    .pill.diesel{ border-color: rgba(11,77,162,.55); background: rgba(11,77,162,.18); }
    .pill.gas{ border-color: rgba(230,0,18,.55); background: rgba(230,0,18,.14); }
    .pill.premium{ border-color: rgba(255,215,0,.40); background: rgba(255,215,0,.12); }
    .pill.motor{ border-color: rgba(234,242,255,.22); background: rgba(234,242,255,.10); }

    .meta{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px 12px;
      color: var(--muted);
      font-size: 13px;
    }
    .meta b{ color: var(--text); font-weight: 700; }
    @media (max-width: 520px){
      .meta{ grid-template-columns: 1fr; }
    }

    .actions{
      display:flex;
      flex-wrap:wrap;
      gap: 10px;
      padding: 0 14px 14px;
      align-items:center;
    }

    .btn{
      appearance:none;
      border: none;
      cursor:pointer;
      border-radius: 14px;
      padding: 10px 12px;
      font-weight: 750;
      font-size: 13px;
      letter-spacing:.15px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap: 8px;
      text-decoration:none;
      user-select:none;
      transition: transform .06s ease, filter .15s ease, opacity .15s ease;
      transform: translateY(0);
      white-space: nowrap;
    }
    .btn:active{ transform: translateY(1px); }
    .btnPrimary{
      background: linear-gradient(180deg, var(--w-red-600), #B8000E);
      color:#fff;
      box-shadow: 0 10px 24px rgba(230,0,18,.22);
    }
    .btnBlue{
      background: linear-gradient(180deg, var(--w-blue-700), var(--w-blue-800));
      color:#fff;
      box-shadow: 0 10px 24px rgba(11,77,162,.20);
    }
    .btnGhost{
      background: rgba(234,242,255,.10);
      border:1px solid rgba(234,242,255,.18);
      color: var(--text);
    }
    .btn:hover{ filter: brightness(1.04); }

    /* Disabled buttons (when no link / no data) */
    .btnDisabled{
      opacity: .45;
      cursor: not-allowed;
      pointer-events: none;
      filter: grayscale(.25);
    }

    .tableWrap{
      padding: 0 14px 14px;
      display:none;
    }
    .tableWrap.open{ display:block; }

    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      overflow:hidden;
      border-radius: 14px;
      border:1px solid rgba(234,242,255,.12);
      background: rgba(4,18,38,.55);
    }
    th, td{
      padding: 10px 10px;
      text-align:left;
      font-size: 13px;
      border-bottom:1px solid rgba(234,242,255,.08);
      vertical-align:top;
    }
    th{
      color: rgba(234,242,255,.92);
      background: rgba(11,77,162,.18);
      border-bottom:1px solid rgba(234,242,255,.12);
      font-size: 12.5px;
      letter-spacing:.2px;
    }
    tr:last-child td{ border-bottom:none; }
    td{
      color: rgba(234,242,255,.86);
    }
    .foot{
      padding: 12px 14px 16px;
      color: rgba(234,242,255,.65);
      font-size: 12px;
      border-top:1px solid var(--border);
      background: rgba(7,27,51,.35);
    }

    .empty{
      padding: 24px 14px 28px;
      color: rgba(234,242,255,.78);
      text-align:center;
      font-size: 14px;
    }
    .empty b{ color:#fff; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="header">
      <div class="brand">
        <div class="badge"><span class="dot"></span> Catálogo interno (USD) – Weichai</div>
        <h1>Buscador por potencia – Generadores y Motores</h1>
        <p class="sub">Elegí una potencia. Si hay potencias repetidas, vas a ver el modelo/variante para evitar confusiones (ej: 22 y 110).</p>
      </div>
    </div>

    <div class="panel">
      <div class="controls">
        <div>
          <label for="powerSelect">Potencia</label>
          <select id="powerSelect" class="select"></select>
        </div>
        <div>
          <label for="quickSearch">Búsqueda rápida (opcional)</label>
          <input id="quickSearch" class="search" type="text" placeholder="Ej: WPG55L1, 70KVA, motor, premium..." />
        </div>
      </div>
      <div class="hint">
        • Los <b>motores</b> no tienen repuestos/folleto/imagen (por ahora).<br/>
        • El generador <b>312 kVA</b> está marcado como <b>GAS</b> (los demás generadores: diésel / premium).
      </div>

      <div id="results" class="grid"></div>
      <div id="empty" class="empty" style="display:none;">
        No encontré resultados con esos filtros. Probá limpiar la búsqueda rápida o elegir otra potencia.
      </div>

      <div class="foot">
        Consejo práctico: para que “Ver/Descargar” funcione perfecto, los archivos de Drive deben estar en <b>“Cualquier persona con el enlace puede ver”</b>.
      </div>
    </div>
  </div>

  <script>
    // -----------------------------
    // Helpers: Google Drive links
    // -----------------------------
    function extractDriveId(url){
      if(!url || typeof url !== "string") return null;
      const m = url.match(/\/d\/([a-zA-Z0-9_-]+)/);
      if(m && m[1]) return m[1];
      const m2 = url.match(/[?&]id=([a-zA-Z0-9_-]+)/);
      if(m2 && m2[1]) return m2[1];
      return null;
    }

    function driveViewUrl(url){
      const id = extractDriveId(url);
      if(!id) return url;
      return `https://drive.google.com/uc?export=view&id=${id}`;
    }

    function driveDownloadUrl(url){
      const id = extractDriveId(url);
      if(!id) return url;
      return `https://drive.google.com/uc?export=download&id=${id}`;
    }

    // -----------------------------
    // Data
    // -----------------------------
    const CURRENCY = "USD";

    const PRODUCTS = [
      // ---------------- GENERADORES ----------------
      {
        kind: "generador",
        fuel: "diesel",
        description: "GENERADOR CABINADO",
        potencia: "22KVA/18KW",
        productNo: "WPG22L1",
        priceUsd: "13.684,01",
        brochureUrl: "https://drive.google.com/file/d/1Fu0HCP_qpFG3PLb8NPpsvB4Bc_v9JpX7/view?usp=drive_link",
        photoUrl: "",
        preventiveParts: [
          { desc:"Filtro de aceite (500 hs)", productNo:"1002525224", priceUsd:"27,44" },
          { desc:"Filtro de aceite (500 hs)", productNo:"1002003753", priceUsd:"31,73" },
          { desc:"Filtro de gasoil primario (500 hs)", productNo:"1000622860", priceUsd:"9,09" },
          { desc:"Correa accesorios (2000 hs)", productNo:"2B0900006 / AV17X940L", priceUsd:"7,84" },
          { desc:"Filtro de aire (500 hs Revisión / 1000 hs)", productNo:"1000940409", priceUsd:"70,88" },
        ],
        correctiveParts: [
          { desc:"Bomba inyectora", productNo:"1003896473", priceUsd:"560,39" },
          { desc:"Junta bomba inyectora", productNo:"1000852702", priceUsd:"1,11" },
          { desc:"Inyector", productNo:"1015968934", priceUsd:"64,02" },
          { desc:"Inyector", productNo:"2010924", priceUsd:"67,06" },
          { desc:"Junta multiple escape", productNo:"1000184083", priceUsd:"2,60" },
          { desc:"Bulon escape", productNo:"1000071147", priceUsd:"2,33" },
          { desc:"Bomba de agua", productNo:"1002262420", priceUsd:"200,71" },
          { desc:"Junta bomba de agua", productNo:"1000795642", priceUsd:"0,84" },
          { desc:"Termostato", productNo:"21033-72-K/155B", priceUsd:"15,36" },
          { desc:"Junta termostato", productNo:"1000846528", priceUsd:"0,57" },
          { desc:"Motor de arranque", productNo:"1001538960", priceUsd:"307,06" },
          { desc:"Alternador", productNo:"2085090110", priceUsd:"153,26" },
          { desc:"Junta tapa de valvula", productNo:"2085040115", priceUsd:"6,08" },
          { desc:"Reten delantero", productNo:"2021995", priceUsd:"4,49" },
          { desc:"Reten trasero", productNo:"2021942", priceUsd:"8,67" },
          { desc:"Sensor de temperatura", productNo:"612600090672", priceUsd:"42,32" },
          { desc:"Sensor de presion", productNo:"P00000360111", priceUsd:"100,98" },
          { desc:"Sensor de velocidad", productNo:"1001668438", priceUsd:"73,20" },
        ]
      },
      {
        kind: "generador",
        fuel: "diesel",
        description: "GENERADOR CABINADO",
        potencia: "22KVA/18KW",
        productNo: "WPG22F1",
        priceUsd: "10.059,68",
        brochureUrl: "https://drive.google.com/file/d/1Fu0HCP_qpFG3PLb8NPpsvB4Bc_v9JpX7/view?usp=drive_link",
        photoUrl: "",
        preventiveParts: [
          { desc:"Filtro de aceite (500 hs)", productNo:"1002525224", priceUsd:"27,44" },
          { desc:"Filtro de aceite (500 hs)", productNo:"1002003753", priceUsd:"31,73" },
          { desc:"Filtro de gasoil primario (500 hs)", productNo:"1000622860", priceUsd:"9,09" },
          { desc:"Correa accesorios (2000 hs)", productNo:"2B0900006 / AV17X940L", priceUsd:"7,84" },
          { desc:"Filtro de aire (500 hs Revisión / 1000 hs)", productNo:"1000940409", priceUsd:"70,88" },
        ],
        correctiveParts: [
          { desc:"Bomba inyectora", productNo:"1003896473", priceUsd:"560,39" },
          { desc:"Junta bomba inyectora", productNo:"1000852702", priceUsd:"1,11" },
          { desc:"Inyector", productNo:"1015968934", priceUsd:"64,02" },
          { desc:"Inyector", productNo:"2010924", priceUsd:"67,06" },
          { desc:"Junta multiple escape", productNo:"1000184083", priceUsd:"2,60" },
          { desc:"Bulon escape", productNo:"1000071147", priceUsd:"2,33" },
          { desc:"Bomba de agua", productNo:"1002262420", priceUsd:"200,71" },
          { desc:"Junta bomba de agua", productNo:"1000795642", priceUsd:"0,84" },
          { desc:"Termostato", productNo:"21033-72-K/155B", priceUsd:"15,36" },
          { desc:"Junta termostato", productNo:"1000846528", priceUsd:"0,57" },
          { desc:"Motor de arranque", productNo:"1001538960", priceUsd:"307,06" },
          { desc:"Alternador", productNo:"2085090110", priceUsd:"153,26" },
          { desc:"Junta tapa de valvula", productNo:"2085040115", priceUsd:"6,08" },
          { desc:"Reten delantero", productNo:"2021995", priceUsd:"4,49" },
          { desc:"Reten trasero", productNo:"2021942", priceUsd:"8,67" },
          { desc:"Sensor de temperatura", productNo:"612600090672", priceUsd:"42,32" },
          { desc:"Sensor de presion", productNo:"P00000360111", priceUsd:"100,98" },
          { desc:"Sensor de velocidad", productNo:"1001668438", priceUsd:"73,20" },
        ]
      },
      {
        kind: "generador",
        fuel: "diesel",
        description: "GENERADOR CABINADO",
        potencia: "41KVA / 33KW",
        productNo: "WPG41L1",
        priceUsd: "15.851,24",
        brochureUrl: "https://drive.google.com/file/d/1BkwfIoCqncz4yidg7bvvH9lURYkg7eyo/view?usp=drive_link",
        photoUrl: "https://drive.google.com/file/d/1MkY6AUN_ls-4CPaVfJ-vumhrkPxGccQA/view?usp=drive_link",
        preventiveParts: [
          { desc:"Filtro de aceite (500 hs)", productNo:"1002003753", priceUsd:"29,01" },
          { desc:"Filtro de aire (500 hs Revisión / 1000 hs)", productNo:"1001069804 / 13069543", priceUsd:"66,41" },
          { desc:"Correa accesorios (2000 hs)", productNo:"2B0900006 / AV17X940L", priceUsd:"7,79" },
          { desc:"Filtro de gasoil primario (500 hs)", productNo:"1000622860", priceUsd:"9,76" },
        ],
        correctiveParts: [
          { desc:"Bomba inyectora", productNo:"1005604711", priceUsd:"1.354,66" },
          { desc:"Junta bomba inyectora", productNo:"1000852702", priceUsd:"1,11" },
          { desc:"Inyector", productNo:"1015968934", priceUsd:"64,02" },
          { desc:"Inyector", productNo:"2010924", priceUsd:"67,06" },
          { desc:"Bomba de agua", productNo:"1001498790", priceUsd:"123,49" },
          { desc:"Junta bomba de agua", productNo:"1000795642", priceUsd:"0,84" },
          { desc:"Termostato", productNo:"21033-72-K/155B", priceUsd:"15,36" },
          { desc:"Junta termostato", productNo:"1000846528", priceUsd:"0,57" },
          { desc:"Alternador", productNo:"2085090110", priceUsd:"153,26" },
          { desc:"Motor de arranque", productNo:"1001557368", priceUsd:"291,63" },
          { desc:"Junta tapa de valvula", productNo:"2085040115", priceUsd:"6,08" },
          { desc:"Reten delantero", productNo:"2021995", priceUsd:"4,49" },
          { desc:"Reten trasero", productNo:"2021942", priceUsd:"8,67" },
          { desc:"Sensor de temperatura", productNo:"612600090672", priceUsd:"42,32" },
          { desc:"Sensor de presion", productNo:"P00000360111", priceUsd:"100,98" },
          { desc:"Sensor de velocidad", productNo:"1001668438", priceUsd:"73,20" },
          { desc:"Turbo", productNo:"1001836952", priceUsd:"889,79" },
          { desc:"Bulon escape", productNo:"1000071147", priceUsd:"2,33" },
          { desc:"Junta multiple escape", productNo:"2060008", priceUsd:"0,51" },
          { desc:"Junta salida turbo", productNo:"1001228133", priceUsd:"4,62" },
          { desc:"Junta turbo", productNo:"1000757316", priceUsd:"1,69" },
          { desc:"Junta descarga turbo", productNo:"2067800", priceUsd:"0,81" },
        ]
      },
      {
        kind: "generador",
        fuel: "diesel",
        description: "GENERADOR CABINADO",
        potencia: "55KVA / 44KW",
        productNo: "WPG55L1",
        priceUsd: "16.470,74",
        brochureUrl: "https://drive.google.com/file/d/1QopodZz0JGrYKJscZhSEdM6vBCz4wkZs/view?usp=drive_link",
        photoUrl: "https://drive.google.com/file/d/1JkPPFYKiTAqE-ADcoW7Yv06Wq8Bwq4u1/view?usp=drive_link",
        preventiveParts: [
          { desc:"Filtro de aire (500 hs Revisión / 1000 hs)", productNo:"1001069804 / 13069543", priceUsd:"69,04" },
          { desc:"Filtro de aceite (500 hs)", productNo:"1002084930", priceUsd:"22,70" },
          { desc:"Filtro de gasoil primario (500 hs)", productNo:"1008230153", priceUsd:"50,89" },
          { desc:"Correa accesorios (2000 hs)", productNo:"1000686462 / AV17X1032", priceUsd:"7,42" },
        ],
        correctiveParts: [
          { desc:"Termostato", productNo:"1000575996", priceUsd:"10,06" },
          { desc:"Bomba de agua", productNo:"1008352096", priceUsd:"154,98" },
          { desc:"Junta bomba de agua", productNo:"1000795642", priceUsd:"0,84" },
          { desc:"Junta tapa de valvula", productNo:"2085040115", priceUsd:"6,08" },
          { desc:"Sensor de fase", productNo:"Z20310003", priceUsd:"70,34" },
          { desc:"Sensor de bba gasoil", productNo:"1000001100", priceUsd:"135,51" },
          { desc:"Sensor de velocidad", productNo:"612630030007", priceUsd:"23,86" },
          { desc:"Sensor de temperatura", productNo:"612630060035", priceUsd:"15,66" },
          { desc:"Sensor presión riel", productNo:"612600081585", priceUsd:"143,84" },
          { desc:"Sensor de presión y temperatura", productNo:"612600090460", priceUsd:"74,12" },
          { desc:"Sensor presión y temperatura refuerzo", productNo:"Z20310004", priceUsd:"61,19" },
          { desc:"Sensor de temperatura", productNo:"612600090672", priceUsd:"42,32" },
          { desc:"Sensor de presion", productNo:"P00000360111", priceUsd:"100,98" },
          { desc:"Reten delantero", productNo:"2021995", priceUsd:"4,49" },
          { desc:"Reten trasero", productNo:"2021942", priceUsd:"8,67" },
          { desc:"Bomba inyectora", productNo:"1000026163", priceUsd:"772,00" },
          { desc:"Inyector", productNo:"1000000623", priceUsd:"342,53" },
          { desc:"Motor de arranque", productNo:"1001557368", priceUsd:"291,63" },
          { desc:"Alternador", productNo:"1002093349", priceUsd:"303,62" },
          { desc:"Turbo", productNo:"1001836952", priceUsd:"889,79" },
          { desc:"Junta salida turbo", productNo:"1001228133", priceUsd:"4,62" },
          { desc:"Junta turbo", productNo:"1000757316", priceUsd:"1,69" },
          { desc:"Junta multiple escape", productNo:"1000184083", priceUsd:"2,60" },
          { desc:"Junta descarga turbo", productNo:"2067800", priceUsd:"0,81" },
          { desc:"Tuerca escape/turbo", productNo:"610800110349", priceUsd:"1,89" },
        ]
      },
      {
        kind: "generador",
        fuel: "diesel",
        description: "GENERADOR CABINADO",
        potencia: "70KVA / 55KW",
        productNo: "WPG70L1",
        priceUsd: "18.546,07",
        brochureUrl: "https://drive.google.com/file/d/1o3Y0IXATo_udBfwc9UHwgDrFTEHAM_5B/view?usp=drive_link",
        photoUrl: "https://drive.google.com/file/d/1HA02gURsQdcA1IUiXiXsU1p_8Sv7FaA-/view?usp=drive_link",
        preventiveParts: [
          { desc:"Filtro de aire (500 hs Revisión / 1000 hs)", productNo:"1001069804 / 13069543", priceUsd:"61,50" },
          { desc:"Correa accesorios (2000 hs)", productNo:"1011315507 AV17X1205 / 1000440251", priceUsd:"8,57" },
          { desc:"Filtro de aceite (500 hs)", productNo:"1002525223 /  1001555805", priceUsd:"16,45" },
          { desc:"Filtro de gasoil primario (500 hs)", productNo:"1011659326", priceUsd:"46,35" },
        ],
        correctiveParts: [
          { desc:"Bomba de agua", productNo:"1004210229", priceUsd:"146,95" },
          { desc:"Junta bomba de agua", productNo:"1000795641", priceUsd:"0,81" },
          { desc:"Termostato", productNo:"1001538000", priceUsd:"22,31" },
          { desc:"Junta termostato", productNo:"1009980978", priceUsd:"3,21" },
          { desc:"Bomba inyectora", productNo:"1005276085", priceUsd:"1.679,47" },
          { desc:"Inyector", productNo:"2105080172", priceUsd:"59,47" },
          { desc:"Inyector", productNo:"1015968936", priceUsd:"67,47" },
          { desc:"Junta tapa de valvula", productNo:"1001217649", priceUsd:"17,28" },
          { desc:"Motor de arranque", productNo:"1001557368", priceUsd:"291,63" },
          { desc:"Alternador", productNo:"1002093349", priceUsd:"303,62" },
          { desc:"Turbo", productNo:"1001737287", priceUsd:"710,67" },
          { desc:"Tuerca escape/turbo", productNo:"610800110349", priceUsd:"1,89" },
          { desc:"Junta descarga turbo", productNo:"2067800", priceUsd:"0,81" },
          { desc:"Junta salida turbo", productNo:"1001103834", priceUsd:"2,40" },
          { desc:"Junta turbo", productNo:"W22022027A", priceUsd:"2,23" },
          { desc:"Bulon escape", productNo:"612630110958", priceUsd:"3,51" },
          { desc:"Junta multiple escape", productNo:"2014546", priceUsd:"1,38" },
          { desc:"Reten delantero", productNo:"2027523", priceUsd:"4,25" },
          { desc:"Reten trasero", productNo:"2027524", priceUsd:"8,98" },
          { desc:"Sensor de presion", productNo:"P00000360111", priceUsd:"100,98" },
          { desc:"Sensor de velocidad", productNo:"1001668438", priceUsd:"73,20" },
          { desc:"Sensor de temperatura", productNo:"1002381183", priceUsd:"47,18" },
        ]
      },
      {
        kind: "generador",
        fuel: "diesel",
        description: "GENERADOR CABINADO",
        potencia: "110kVA / 88kW",
        productNo: "WPG110L1",
        variant: "Standard",
        priceUsd: "23.152,73",
        brochureUrl: "https://drive.google.com/file/d/1Wf6634neuJGYfdHXx2EQZwwp_h9PnE2B/view?usp=drive_link",
        photoUrl: "https://drive.google.com/file/d/12tIsTuddCvN9GA6svsvQ1z1u5656exRX/view?usp=drive_link",
        preventiveParts: [
          { desc:"Filtro de aire (500 hs Revisión / 1000 hs)", productNo:"1001069804 / 13069543", priceUsd:"69,04" },
          { desc:"Correa accesorios (2000 hs)", productNo:"1005913470 / 8PK1347", priceUsd:"17,61" },
          { desc:"Correa accesorios (2000 hs)", productNo:"1011315507 AV17X1205 / 1000440251", priceUsd:"6,75" },
          { desc:"Filtro de aceite (500 hs)", productNo:"1002525223 /1001555805", priceUsd:"18,09" },
          { desc:"Filtro de gasoil primario (500 hs)", productNo:"1011659326", priceUsd:"45,78" },
        ],
        correctiveParts: [
          { desc:"Bomba de agua", productNo:"1004210229", priceUsd:"146,95" },
          { desc:"Junta bomba de agua", productNo:"1000795641", priceUsd:"0,81" },
          { desc:"Termostato", productNo:"1001538000", priceUsd:"22,31" },
          { desc:"Junta termostato", productNo:"1009980978", priceUsd:"3,21" },
          { desc:"Alternador", productNo:"1001560878", priceUsd:"303,62" },
          { desc:"Motor de arranque", productNo:"1001557368", priceUsd:"291,63" },
          { desc:"Alternador", productNo:"1002093349", priceUsd:"303,62" },
          { desc:"Tensor de correa", productNo:"1004933136", priceUsd:"93,22" },
          { desc:"Junta tapa de valvula", productNo:"1001217649", priceUsd:"17,28" },
          { desc:"Bomba inyectora", productNo:"1005276085", priceUsd:"1.679,47" },
          { desc:"Inyector", productNo:"2100235", priceUsd:"67,06" },
          { desc:"Inyector", productNo:"1015775889", priceUsd:"67,47" },
          { desc:"Turbo", productNo:"1001689095", priceUsd:"705,24" },
          { desc:"Tuerca escape/turbo", productNo:"610800110349", priceUsd:"1,89" },
          { desc:"Junta descarga turbo", productNo:"2067800", priceUsd:"0,81" },
          { desc:"Junta salida turbo", productNo:"1001103834", priceUsd:"2,40" },
          { desc:"Junta turbo", productNo:"W22022027A", priceUsd:"2,23" },
          { desc:"Bulon escape", productNo:"612630110958", priceUsd:"3,51" },
          { desc:"Junta multiple escape", productNo:"2014546", priceUsd:"1,38" },
          { desc:"Reten delantero", productNo:"2027523", priceUsd:"4,25" },
          { desc:"Reten trasero", productNo:"2027524", priceUsd:"8,98" },
          { desc:"Sensor de presion", productNo:"P00000360111", priceUsd:"100,98" },
          { desc:"Sensor de velocidad", productNo:"1001668438", priceUsd:"73,20" },
          { desc:"Sensor de temperatura", productNo:"1002381183", priceUsd:"47,18" },
        ]
      },
      {
        kind: "generador",
        fuel: "premium",
        description: "GENERADORES DIESEL CAB. PREMIUM",
        potencia: "110kVA / 88kW",
        productNo: "WPG110L1",
        variant: "Premium",
        priceUsd: "31.711,15",
        brochureUrl: "https://drive.google.com/file/d/1Wf6634neuJGYfdHXx2EQZwwp_h9PnE2B/view?usp=drive_link",
        photoUrl: "https://drive.google.com/file/d/1CugpJ3C-hVjdoSZff1mmmaZ9sGsqC1LK/view?usp=drive_link",
        preventiveParts: [
          { desc:"Filtro de aire (500 hs Revisión / 1000 hs)", productNo:"1001069804 / 13069543", priceUsd:"69,04" },
          { desc:"Correa accesorios (2000 hs)", productNo:"1005913470 / 8PK1347", priceUsd:"17,61" },
          { desc:"Correa accesorios (2000 hs)", productNo:"1011315507 AV17X1205 / 1000440251", priceUsd:"6,75" },
          { desc:"Filtro de aceite (500 hs)", productNo:"1002525223 /1001555805", priceUsd:"18,09" },
          { desc:"Filtro de gasoil primario (500 hs)", productNo:"1011659326", priceUsd:"45,78" },
        ],
        correctiveParts: [
          { desc:"Bomba de agua", productNo:"1004210229", priceUsd:"146,95" },
          { desc:"Junta bomba de agua", productNo:"1000795641", priceUsd:"0,81" },
          { desc:"Termostato", productNo:"1001538000", priceUsd:"22,31" },
          { desc:"Junta termostato", productNo:"1009980978", priceUsd:"3,21" },
          { desc:"Alternador", productNo:"1001560878", priceUsd:"303,62" },
          { desc:"Motor de arranque", productNo:"1001557368", priceUsd:"291,63" },
          { desc:"Alternador", productNo:"1002093349", priceUsd:"303,62" },
          { desc:"Tensor de correa", productNo:"1004933136", priceUsd:"93,22" },
          { desc:"Junta tapa de valvula", productNo:"1001217649", priceUsd:"17,28" },
          { desc:"Bomba inyectora", productNo:"1005276085", priceUsd:"1.679,47" },
          { desc:"Inyector", productNo:"2100235", priceUsd:"67,06" },
          { desc:"Inyector", productNo:"1015775889", priceUsd:"67,47" },
          { desc:"Turbo", productNo:"1001689095", priceUsd:"705,24" },
          { desc:"Tuerca escape/turbo", productNo:"610800110349", priceUsd:"1,89" },
          { desc:"Junta descarga turbo", productNo:"2067800", priceUsd:"0,81" },
          { desc:"Junta salida turbo", productNo:"1001103834", priceUsd:"2,40" },
          { desc:"Junta turbo", productNo:"W22022027A", priceUsd:"2,23" },
          { desc:"Bulon escape", productNo:"612630110958", priceUsd:"3,51" },
          { desc:"Junta multiple escape", productNo:"2014546", priceUsd:"1,38" },
          { desc:"Reten delantero", productNo:"2027523", priceUsd:"4,25" },
          { desc:"Reten trasero", productNo:"2027524", priceUsd:"8,98" },
          { desc:"Sensor de presion", productNo:"P00000360111", priceUsd:"100,98" },
          { desc:"Sensor de velocidad", productNo:"1001668438", priceUsd:"73,20" },
          { desc:"Sensor de temperatura", productNo:"1002381183", priceUsd:"47,18" },
        ]
      },
      {
        kind: "generador",
        fuel: "diesel",
        description: "GENERADOR CABINADO",
        potencia: "275kVA / 220kW",
        productNo: "WPG275L8",
        priceUsd: "43.639,96",
        brochureUrl: "https://drive.google.com/file/d/1ykvSRfz_qApLX30Pu7s6NMF-fga8jylM/view?usp=drive_link",
        photoUrl: "https://drive.google.com/file/d/1yo03Ug_vlzKflqIS6DelUKHTw0dEtIai/view?usp=drive_link",
        preventiveParts: [
          { desc:"Filtro de aire (500 hs Revisión / 1000 hs)", productNo:"612600114890", priceUsd:"90,96" },
          { desc:"Correa accesorios (2000 hs)", productNo:"61260006136", priceUsd:"37,04" },
          { desc:"Filtro de aceite (500 hs)", productNo:"1000942192", priceUsd:"14,97" },
          { desc:"Filtro de gasoil c/trampa de agua (500 hs)", productNo:"1000053557 / 1000632620", priceUsd:"65,25" },
          { desc:"Filtro de gasoil primario (500 hs)", productNo:"1000816697", priceUsd:"22,77" },
        ],
        correctiveParts: [
          { desc:"Bomba inyectora", productNo:"1003019031", priceUsd:"2.118,62" },
          { desc:"Inyector", productNo:"61560080276", priceUsd:"141,58" },
          { desc:"Turbo", productNo:"1000951730", priceUsd:"791,98" },
          { desc:"Junta salida turbo", productNo:"612600115408", priceUsd:"5,30" },
          { desc:"Junta descarga turbo", productNo:"612600114275", priceUsd:"0,61" },
          { desc:"Junta descarga turbo", productNo:"612600115514", priceUsd:"1,01" },
          { desc:"Bulon escape", productNo:"61560110104", priceUsd:"2,06" },
          { desc:"Bulon escape", productNo:"612600110252", priceUsd:"2,80" },
          { desc:"Bulon escape", productNo:"61560110105", priceUsd:"2,09" },
          { desc:"Tuercaturbo", productNo:"1001867055", priceUsd:"5,47" },
          { desc:"Junta turbo", productNo:"61560110210", priceUsd:"4,69" },
          { desc:"Junta multiple escape", productNo:"612600114293", priceUsd:"3,21" },
          { desc:"Junta tapa de valvula", productNo:"612600040565", priceUsd:"6,48" },
          { desc:"Reten delantero", productNo:"61500010037", priceUsd:"18,43" },
          { desc:"Reten trasero", productNo:"61500010100", priceUsd:"22,85" },
          { desc:"Bomba de agua", productNo:"1001045335", priceUsd:"292,61" },
          { desc:"Junta bomba de agua", productNo:"612600061635", priceUsd:"4,69" },
          { desc:"Termostato", productNo:"615G00060016", priceUsd:"55,82" },
          { desc:"Motor de arranque", productNo:"1001690858", priceUsd:"1.223,37" },
          { desc:"Alternador", productNo:"1000884944", priceUsd:"409,62" },
          { desc:"Tensor de correa", productNo:"612600061256", priceUsd:"172,77" },
          { desc:"Sensor de presión", productNo:"P00000360113", priceUsd:"100,98" },
          { desc:"Sensor de temperatura", productNo:"612600090672", priceUsd:"42,32" },
          { desc:"Sensor de velocidad", productNo:"612600190113", priceUsd:"84,71" },
        ]
      },
      {
        kind: "generador",
        fuel: "diesel",
        description: "GENERADOR CABINADO",
        potencia: "550KVA / 440KW",
        productNo: "WPG550L8",
        priceUsd: "84.297,66",
        brochureUrl: "https://drive.google.com/file/d/1kUJGi8n4HPohxhzVnslyGPqCzh1fiV3o/view?usp=drive_link",
        photoUrl: "https://drive.google.com/file/d/1fAvwWl8hsw1c4hYRpJMOqM3_F8BeJMnt/view?usp=drive_link",
        preventiveParts: [
          { desc:"Correa accesorios (2000 hs)", productNo:"1004351542", priceUsd:"50,15" },
          { desc:"Correa accesorios (2000 hs)", productNo:"1000578844", priceUsd:"53,47" },
          { desc:"Filtro de aceite (500 hs)", productNo:"1007593009 / 1000428205", priceUsd:"34,46" },
          { desc:"Filtro de gasoil c/trampa de agua (500 hs)", productNo:"1007593016 / 1000053557 / 1000632620", priceUsd:"46,00" },
          { desc:"Filtro de gasoil primario (500 hs)", productNo:"1007593004 / 1000053555", priceUsd:"36,87" },
          { desc:"Filtro de aire (500 hs Revisión / 1000 hs)", productNo:"612600114890", priceUsd:"82,70" },
          { desc:"Filtro de gasoil secundario (500 hs)", productNo:"1007593006 / 1000747688", priceUsd:"40,19" },
        ],
        correctiveParts: [
          { desc:"Tensor de correa", productNo:"1000694241", priceUsd:"128,18" },
          { desc:"Bomba inyectora", productNo:"612640080039", priceUsd:"2.337,49" },
          { desc:"Inyector", productNo:"612630090025", priceUsd:"550,90" },
          { desc:"Turbo", productNo:"1007388622", priceUsd:"3.573,69" },
          { desc:"Junta multiple escape", productNo:"1009664879", priceUsd:"6,55" },
          { desc:"Junta turbo", productNo:"1001875918", priceUsd:"4,62" },
          { desc:"Junta descarga turbo", productNo:"1001317646", priceUsd:"0,81" },
          { desc:"Junta descarga turbo", productNo:"1006073288", priceUsd:"0,78" },
          { desc:"Junta turbo", productNo:"1001875918", priceUsd:"4,62" },
          { desc:"Bomba de agua", productNo:"1007602620", priceUsd:"712,26" },
          { desc:"Termostato", productNo:"612630061126", priceUsd:"20,62" },
          { desc:"Junta termostato", productNo:"612630060067", priceUsd:"2,94" },
          { desc:"Alternador", productNo:"1000884973", priceUsd:"514,99" },
          { desc:"Motor de arranque", productNo:"612630030277", priceUsd:"1.011,59" },
          { desc:"Junta tapa de valvula", productNo:"612630040007", priceUsd:"6,85" },
          { desc:"Reten delantero", productNo:"1002052027", priceUsd:"37,40" },
          { desc:"Reten trasero", productNo:"1001994648", priceUsd:"45,26" },
          { desc:"Sensor de velocidad", productNo:"612630030007", priceUsd:"23,86" },
          { desc:"Sensor de temperatura", productNo:"612630060035", priceUsd:"15,66" },
          { desc:"Sensor de presión y temperatura", productNo:"1001413692", priceUsd:"110,23" },
          { desc:"Sensor presión y temperatura refuerzo", productNo:"1002870099", priceUsd:"109,45" },
        ]
      },

      // ---------------- GENERADOR GAS ----------------
      {
        kind: "generador",
        fuel: "gas",
        description: "GENERADORES A GAS",
        potencia: "312KVA/250KW",
        productNo: "WPG312L8NG",
        priceUsd: "125.512,08",
        brochureUrl: "",
        photoUrl: "",
        preventiveParts: [
          { desc:"Correa accesorios (2000 hs)", productNo:"612700060040", priceUsd:"22,43" },
          { desc:"Correa accesorios (2000 hs)", productNo:"612630060974", priceUsd:"36,83" },
          { desc:"Filtro de aire (500 hs Revisión / 1000 hs)", productNo:"612600114890", priceUsd:"88,97" },
          { desc:"Filtro de aceite (500 hs)", productNo:"1000942196", priceUsd:"30,95" },
        ],
        correctiveParts: [
          { desc:"Bobina", productNo:"612600190686", priceUsd:"267,67" },
          { desc:"Bujias", productNo:"1000450457", priceUsd:"87,55" },
          { desc:"Cable bujia", productNo:"612600191684", priceUsd:"159,32" },
          { desc:"Altronic", productNo:"1000719658", priceUsd:"420,86" },
          { desc:"Bomba de agua", productNo:"1001803757", priceUsd:"643,75" },
          { desc:"Termostato", productNo:"612630061126", priceUsd:"20,62" },
          { desc:"Junta termostato", productNo:"612630060067", priceUsd:"2,94" },
          { desc:"Tensor de correa", productNo:"612630060972", priceUsd:"123,29" },
          { desc:"Turbo", productNo:"612700190108", priceUsd:"1.737,18" },
          { desc:"Junta multiple escape", productNo:"1009664879", priceUsd:"6,55" },
          { desc:"Junta turbo", productNo:"61560110210", priceUsd:"4,69" },
          { desc:"Alternador", productNo:"1000884973", priceUsd:"514,99" },
          { desc:"Motor de arranque", productNo:"1001778863", priceUsd:"1.036,73" },
          { desc:"Junta tapa de valvula", productNo:"612630040007", priceUsd:"6,85" },
          { desc:"Reten delantero", productNo:"1002052027", priceUsd:"37,40" },
          { desc:"Reten trasero", productNo:"1001994648", priceUsd:"45,26" },
          { desc:"Sensor de fase", productNo:"410800190039", priceUsd:"57,14" },
          { desc:"Sensor de temperatura", productNo:"612600090766", priceUsd:"134,87" },
          { desc:"Sensor de velocidad", productNo:"612600190113", priceUsd:"84,71" },
        ]
      },

      // ---------------- MOTORES ----------------
      { kind:"motor", description:"MOTORES DIESEL 1500RPM", potencia:"33kVA / 30kW", productNo:"4M06G35/5", priceUsd:"5.747,11" },
      { kind:"motor", description:"MOTORES DIESEL 1500RPM", potencia:"50kVA / 45kW", productNo:"4M06G50/5", priceUsd:"6.483,91" },
      { kind:"motor", description:"MOTORES DIESEL 1500RPM", potencia:"110kVA / 100kW", productNo:"4M10G110/5", priceUsd:"9.058,48" },
      { kind:"motor", description:"MOTORES DIESEL -ACELERACION VARIABLE", potencia:"", productNo:"WD10G220E23", priceUsd:"19.895,94" },
      { kind:"motor", description:"MOTORES DIESEL -ACELERACION VARIABLE", potencia:"", productNo:"WP6G125E22", priceUsd:"8.646,27" },
      { kind:"motor", description:"MOTORES DIESEL", potencia:"25 KW", productNo:"4M06G20/5", priceUsd:"4.623,97" },
      { kind:"motor", description:"MOTORES DIESEL", potencia:"66 KW", productNo:"4M10G70/5", priceUsd:"6.553,80" },
      { kind:"motor", description:"MOTORES DIESEL", potencia:"264 KW", productNo:"6M16G275/5", priceUsd:"18.406,69" },
      { kind:"motor", description:"MOTORES DIESEL", potencia:"499 KW", productNo:"6M21G550/5", priceUsd:"33.279,68" },
      { kind:"motor", description:"MOTORES DIESEL", potencia:"70 KW/94 HP", productNo:"4M10V4D0", priceUsd:"10.063,17" },
    ];

    // -----------------------------
    // Dropdown + UI refs
    // -----------------------------
    const powerSelect = document.getElementById("powerSelect");
    const quickSearch = document.getElementById("quickSearch");
    const resultsEl = document.getElementById("results");
    const emptyEl = document.getElementById("empty");

    function normalize(s){
      return (s || "")
        .toString()
        .trim()
        .toLowerCase()
        .replace(/\s+/g, " ");
    }

    function getPowerKey(potencia){
      const p = (potencia || "").trim();
      return p ? p : "SIN_ESPECIFICAR";
    }

    function fuelLabel(p){
      if(p.kind === "motor") return "Motor";
      if(p.fuel === "gas") return "Gas";
      if(p.fuel === "premium") return "Premium";
      return "Diesel";
    }

    function pillClass(p){
      if(p.kind === "motor") return "motor";
      if(p.fuel === "gas") return "gas";
      if(p.fuel === "premium") return "premium";
      return "diesel";
    }

    function priceText(p){
      return `${CURRENCY} ${p.priceUsd}`;
    }

    // Dropdown label (menos confuso: GEN vs MOTOR)
    function optionLabel(p){
      const pot = (p.potencia || "").trim() ? p.potencia.trim() : "Sin especificar";
      const kindTag = (p.kind === "motor") ? "[MOTOR]" : "[GEN]";
      const fuelTag = (p.kind === "motor")
        ? ""
        : (p.fuel === "gas" ? " GAS" : (p.fuel === "premium" ? " PREMIUM" : " DIESEL"));
      const variant = p.variant ? ` – ${p.variant}` : "";
      return `${kindTag}${fuelTag} ${pot} — ${p.productNo}${variant}`;
    }

    function sortByPowerThenModel(a,b){
      const pa = getPowerKey(a.potencia);
      const pb = getPowerKey(b.potencia);
      if(pa === "SIN_ESPECIFICAR" && pb !== "SIN_ESPECIFICAR") return 1;
      if(pb === "SIN_ESPECIFICAR" && pa !== "SIN_ESPECIFICAR") return -1;
      const c = pa.localeCompare(pb, "es", { numeric:true, sensitivity:"base" });
      if(c !== 0) return c;
      const m = (a.productNo || "").localeCompare((b.productNo || ""), "es", { numeric:true, sensitivity:"base" });
      if(m !== 0) return m;
      return ((a.variant||"").localeCompare((b.variant||""), "es", { numeric:true, sensitivity:"base" }));
    }

    function buildDropdown(){
      powerSelect.innerHTML = "";

      const optAll = document.createElement("option");
      optAll.value = "__ALL__";
      optAll.textContent = "Todos (Generadores + Motores)";
      powerSelect.appendChild(optAll);

      const gens = PRODUCTS.filter(p => p.kind === "generador").sort(sortByPowerThenModel);
      const motors = PRODUCTS.filter(p => p.kind === "motor").sort(sortByPowerThenModel);

      const ogGen = document.createElement("optgroup");
      ogGen.label = "GENERADORES";
      for(const p of gens){
        const opt = document.createElement("option");
        opt.value = `${getPowerKey(p.potencia)}|||${p.productNo}|||${p.variant || ""}|||${p.kind}`;
        opt.textContent = optionLabel(p);
        ogGen.appendChild(opt);
      }

      const ogMot = document.createElement("optgroup");
      ogMot.label = "MOTORES";
      for(const p of motors){
        const opt = document.createElement("option");
        opt.value = `${getPowerKey(p.potencia)}|||${p.productNo}|||${p.variant || ""}|||${p.kind}`;
        opt.textContent = optionLabel(p);
        ogMot.appendChild(opt);
      }

      powerSelect.appendChild(ogGen);
      powerSelect.appendChild(ogMot);
    }

    // -----------------------------
    // Rendering
    // -----------------------------
    function render(){
      const selected = powerSelect.value;
      const q = normalize(quickSearch.value);

      let filtered = [...PRODUCTS];

      if(selected && selected !== "__ALL__"){
        const [k, productNo, variant, kind] = selected.split("|||");
        filtered = filtered.filter(p => {
          const pk = getPowerKey(p.potencia);
          const pv = (p.variant || "");
          return pk === k && p.productNo === productNo && pv === variant && p.kind === kind;
        });
      }

      if(q){
        filtered = filtered.filter(p => {
          const hay = [
            p.kind,
            p.description,
            p.potencia,
            p.productNo,
            p.variant,
            p.fuel
          ].map(normalize).join(" | ");
          return hay.includes(q);
        });
      }

      resultsEl.innerHTML = "";
      emptyEl.style.display = filtered.length ? "none" : "block";

      for(const p of filtered){
        resultsEl.appendChild(buildCard(p));
      }
    }

    function buildCard(p){
      const card = document.createElement("div");
      card.className = "card";

      const top = document.createElement("div");
      top.className = "cardTop";

      const imgBox = document.createElement("div");
      imgBox.className = "imgBox";

      // --- Imagen: si no hay o falla, NO mostrar zócalo/mensaje (se oculta)
      const hasPhoto = !!(p.photoUrl && p.photoUrl.trim());
      if(hasPhoto){
        const img = document.createElement("img");
        img.alt = `${p.description} ${p.productNo}`;
        img.src = driveViewUrl(p.photoUrl);
        img.loading = "lazy";
        img.onerror = () => {
          // Ocultar completamente para no "ensuciar" la ficha
          imgBox.classList.add("hidden");
        };
        imgBox.appendChild(img);
      } else {
        imgBox.classList.add("hidden");
      }

      const content = document.createElement("div");
      content.className = "content";

      const titleRow = document.createElement("div");
      titleRow.className = "titleRow";

      const title = document.createElement("h3");
      title.className = "title";
      const variant = p.variant ? ` (${p.variant})` : "";
      title.textContent = `${p.description}${variant}`;

      const pill = document.createElement("div");
      pill.className = `pill ${pillClass(p)}`;
      pill.textContent = fuelLabel(p);

      titleRow.appendChild(title);
      titleRow.appendChild(pill);

      const meta = document.createElement("div");
      meta.className = "meta";

      const potenciaTxt = (p.potencia && p.potencia.trim()) ? p.potencia.trim() : "Sin especificar";
      meta.innerHTML = `
        <div><b>Potencia:</b> ${potenciaTxt}</div>
        <div><b>Modelo:</b> ${escapeHtml(p.productNo)}</div>
        <div><b>Precio:</b> ${priceText(p)}</div>
        <div><b>Tipo:</b> ${p.kind === "motor" ? "Motor" : "Generador"}</div>
      `;

      content.appendChild(titleRow);
      content.appendChild(meta);

      // Si no hay imagen, el top queda solo con contenido (más prolijo)
      if(!imgBox.classList.contains("hidden")) top.appendChild(imgBox);
      top.appendChild(content);

      const actions = document.createElement("div");
      actions.className = "actions";

      // --- Botones siempre presentes (pero deshabilitados si no aplica)
      // FOTO
      const viewImg = document.createElement("a");
      viewImg.className = "btn btnGhost";
      viewImg.textContent = "Ver foto";
      if(hasPhoto){
        viewImg.href = p.photoUrl;
        viewImg.target = "_blank";
        viewImg.rel = "noopener noreferrer";
      } else {
        viewImg.classList.add("btnDisabled");
        viewImg.title = "Sin foto cargada";
        viewImg.href = "javascript:void(0)";
      }

      const dlImg = document.createElement("a");
      dlImg.className = "btn btnBlue";
      dlImg.textContent = "Descargar foto";
      if(hasPhoto){
        dlImg.href = driveDownloadUrl(p.photoUrl);
        dlImg.target = "_blank";
        dlImg.rel = "noopener noreferrer";
      } else {
        dlImg.classList.add("btnDisabled");
        dlImg.title = "Sin foto cargada";
        dlImg.href = "javascript:void(0)";
      }

      // FOLLETO
      const hasBrochure = !!(p.brochureUrl && p.brochureUrl.trim());
      const dlBro = document.createElement("a");
      dlBro.className = "btn btnPrimary";
      dlBro.textContent = "Descargar folleto";
      if(hasBrochure){
        dlBro.href = driveDownloadUrl(p.brochureUrl);
        dlBro.target = "_blank";
        dlBro.rel = "noopener noreferrer";
      } else {
        dlBro.classList.add("btnDisabled");
        dlBro.title = "Sin folleto cargado";
        dlBro.href = "javascript:void(0)";
      }

      actions.appendChild(viewImg);
      actions.appendChild(dlImg);
      actions.appendChild(dlBro);

      // REPUESTOS (Preventivos + Correctivos)
      const hasPreventive = Array.isArray(p.preventiveParts) && p.preventiveParts.length > 0;
      const hasCorrective = Array.isArray(p.correctiveParts) && p.correctiveParts.length > 0;

      const prevWrap = document.createElement("div");
      prevWrap.className = "tableWrap";

      const corrWrap = document.createElement("div");
      corrWrap.className = "tableWrap";

      const btnPrev = document.createElement("button");
      btnPrev.className = "btn btnGhost";
      btnPrev.type = "button";
      btnPrev.textContent = "Repuestos preventivos";
      if(hasPreventive){
        btnPrev.onclick = () => {
          prevWrap.classList.toggle("open");
          btnPrev.textContent = prevWrap.classList.contains("open")
            ? "Ocultar repuestos preventivos"
            : "Repuestos preventivos";
        };
        prevWrap.appendChild(buildPartsTable(p.preventiveParts));
      } else {
        btnPrev.classList.add("btnDisabled");
        btnPrev.title = "Sin repuestos preventivos";
      }

      const btnCorr = document.createElement("button");
      btnCorr.className = "btn btnGhost";
      btnCorr.type = "button";
      btnCorr.textContent = "Repuestos correctivos";
      if(hasCorrective){
        btnCorr.onclick = () => {
          corrWrap.classList.toggle("open");
          btnCorr.textContent = corrWrap.classList.contains("open")
            ? "Ocultar repuestos correctivos"
            : "Repuestos correctivos";
        };
        corrWrap.appendChild(buildPartsTable(p.correctiveParts));
      } else {
        btnCorr.classList.add("btnDisabled");
        btnCorr.title = "Sin repuestos correctivos";
      }

      actions.appendChild(btnPrev);
      actions.appendChild(btnCorr);

      card.appendChild(top);
      card.appendChild(actions);
      if(hasPreventive) card.appendChild(prevWrap);
      if(hasCorrective) card.appendChild(corrWrap);

      return card;
    }

    function buildPartsTable(items){
      const table = document.createElement("table");

      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th style="width:46%">Descripción</th>
          <th style="width:26%">N° Producto</th>
          <th style="width:28%">Precio (USD)</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      for(const it of items){
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${escapeHtml(it.desc)}</td>
          <td>${escapeHtml(it.productNo)}</td>
          <td>${CURRENCY} ${escapeHtml(it.priceUsd)}</td>
        `;
        tbody.appendChild(tr);
      }
      table.appendChild(tbody);

      return table;
    }

    function escapeHtml(str){
      return (str ?? "").toString()
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // -----------------------------
    // Init
    // -----------------------------
    buildDropdown();
    render();

    powerSelect.addEventListener("change", render);
    quickSearch.addEventListener("input", () => {
      window.requestAnimationFrame(render);
    });
  </script>
</body>
</html>


